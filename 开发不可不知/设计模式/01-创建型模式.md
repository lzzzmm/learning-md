# 1-设计模式-创建型模式
## 1 工厂方法


```cs
public abstract class MerchFoodPreparing
{
    public abstract Task Box();

    public virtual async Task Waiting()
    {
        //pass base body
    }
    public abstract Task Complete();
}

public class PickupMerchFoodPreparing : MerchFoodPreparing
{
    public override async Task Box()
    {
        // pass body
    }

    public override async Task Complete()
    {
        // pass body
    }

    public override async Task Waiting()
    {
        // pass pockup body
    }
}

public class DeliveryMerchFoodPreparing : MerchFoodPreparing
{
    public override async Task Box()
    {
        // pass body
    }

    public override async Task Complete()
    {
        // pass body
    }

    public override async Task Waiting()
    {
        // pass delivery body
    }
}

public abstract class MerchFoodPreparingFactory
{
    public abstract MerchFoodPreparing MerchFoodPreparing();

    public async Task MerchFoodSaleProcess()
    {
        var merchFoodPreparing = MerchFoodPreparing();
        await merchFoodPreparing.Box();
        await merchFoodPreparing.Waiting();
        await merchFoodPreparing.Complete();
    }
}

public class PickupMerchFoodPreparingFactory : MerchFoodPreparingFactory
{
    public override MerchFoodPreparing MerchFoodPreparing()
    {
        return new PickupMerchFoodPreparing();
    }
}

public class DeliveryMerchFoodPreparingFactory : MerchFoodPreparingFactory
{
    public override MerchFoodPreparing MerchFoodPreparing()
    {
        return new DeliveryMerchFoodPreparing();
    }
}
```

## 2、抽象工厂模式

```cs
public abstract class BoxSeaMerchFood
{
    public abstract Task SeaBox();
    public abstract Task Waiting();
    public virtual async Task Complete(){}
}

public abstract class BoxDryMerchFood
{
    public abstract Task DryBox();
    public abstract Task Waiting();
    public virtual async Task Complete(){}
}

public class PickupSeaMerchFood : BoxSeaMerchFood
{
    public override async Task SeaBox()
    {
        // pass
    }

    public override async Task Waiting()
    {
        // pass
    }
}

public class DeliverySeaMerchFood : BoxSeaMerchFood
{
    public override async Task SeaBox()
    {
        // pass
    }
    public override async Task Waiting()
    {
        // pass
    }
}

public class PickupDryMerchFood : BoxDryMerchFood
{
    public override async Task DryBox()
    {
        // pass
    }
    public override async Task Waiting()
    {
        // pass
    }
}

public class DeliveryDryMerchFood : BoxDryMerchFood
{
    public override async Task DryBox()
    {
        // pass
    }
    public override async Task Waiting()
    {
        // pass
    }
}

interface AbstractFactory
{
    public BoxSeaMerchFood SeaMerchFoodPreparing();
    public BoxDryMerchFood DryMerchFoodPreparing();
}

public class PickupMerchFoodPreparingAbstractFactory : AbstractFactory
{
    public BoxSeaMerchFood SeaMerchFoodPreparing() {
        return new PickupSeaMerchFood();
    }

    public BoxDryMerchFood DryMerchFoodPreparing() {
        return new PickupDryMerchFood();
    }
}

public class DeliveryMerchFoodPreparingAbstractFactory : AbstractFactory
{
    public BoxSeaMerchFood SeaMerchFoodPreparing()
    {
        return new DeliverySeaMerchFood();
    }

    public BoxDryMerchFood DryMerchFoodPreparing()
    {
        return new DeliveryDryMerchFood();
    }
}
```

## 生成器模式
![2024-10-22-15-45-44.png](./images/2024-10-22-15-45-44.png)

```cs
public interface Builder
{
    Task CreateProduct();
    Task DineIn();
    Task Delivery();
}

public class DineInMerchBuilder : Builder
{
    public async Task CreateProduct()
    {
        // pass
    }

    public async Task DineIn()
    {
        // pass
    }

    public Task Delivery()
    {
        throw new NotImplementedException();
    }

    public async Task GetResult()
    {
        CreateProduct();
        DineIn();
        // return DineInMerch
    }
}

public class  DeliveryMerchBuilder : Builder
{
    public async Task CreateProduct()
    {
        // pass
    }

    public async Task DineIn()
    {
        throw new NotImplementedException();
    }

    public async Task Delivery()
    {
        // pass
    }
    public async Task GetResult()
    {
        CreateProduct();
        DineIn();
        // return DeliveryMerch
    }
}

public class Director
{
    public async Task Build(int type)
    {
        if (type == 1)
        {
            var builder = new DineInMerchBuilder();
            await builder.GetResult();
        }
        else
        {
            var builder = new DeliveryMerchBuilder();
            await builder.GetResult();
        }
    }
}
```

## 原型模式

```cs
public class Car
{
    public string Name { get; set; }
    public InfoCar InfoCar { get; set; }

    public void Build()
    {
        Console.WriteLine("build...");
    }
    // 实现克隆方法
    public Car Clone()
    {
        // 浅克隆对象 引用类型的InfoCar是引用同个地址
        return (Car)this.MemberwiseClone();
    }
    // 深克隆
    public Car DeepCopy()
    {
        var clone = Clone();
        clone.InfoCar = new InfoCar() { info = InfoCar.info };
        return clone;
    }
}

public class InfoCar
{
    public string info { get; set; }
}
```

## 单例模式
```cs
// sealed就不能被继承或重写啦
public sealed class Singleton
{
    // 单例不能被随便构造，所以要private
    private Singleton() { }
    private static Singleton _instance;
    // 每次调用拿到的就是同一个实例
    public static Singleton GetInstance()
    {
        if (_instance == null)
        {
            _instance = new Singleton();
        }
        return _instance;
    }
}

public sealed class SingletonSafe
{
    private SingletonSafe() { }
    private static SingletonSafe _instance;
    private static readonly object _lock = new object();
    
    public static SingletonSafe GetInstance()
    {
        if (_instance == null)
        {
            lock (_lock)
            {
                if (_instance == null)
                {
                    _instance = new SingletonSafe();
                }
            }
        }
        return _instance;
    }
} 
```